container_commands:
  01_create_log_file:
    command: echo "" > /opt/python/log/collector.log

  02_change_owner:
    command: chown wsgi:root /opt/python/log/collector.log

  03_change_permissions:
    command: chmod 666 /opt/python/log/collector.log

  04_create_cronjob:
    command: echo "0 * * * * /opt/python/run/venv/bin/python3 /opt/python/current/app/collect_data.py" > /tmp/cronjob && crontab /tmp/cronjob
    leader_only: true

  05_log_structure:
    command: find /opt/python/current/ >> /opt/python/log/collector.log
    leader_only: true

  06_log_pip_list:
    command: pip3 list >> /opt/python/log/collector.log
    leader_only: true

  07_log_user:
    command: echo "$(who)" >> /opt/python/log/collector.log
    leader_only: true

  08_delete_cronjob_file:
    command: rm /tmp/cronjob
    leader_only: true
